;(function($,f,g){var h=$(f);$.widget("mobile.validate",{options:{validatemessagevalid:"",validatemessageinvalid:"",validatetype:"",validateon:"input",required:false,validateoffsetfirsterror:45,validateshowerrormessage:true,validateoffsettop:0,validateoffsetbottom:0,validatedisplayname:""},_create:function(){var a=this;a.options.required=a.element.attr("required")?true:false;a.element.attr("step")=="any"&&(a.options.validatetype="digit");a.options.validatetype=a.element.attr("pattern")||a.options.validatetype;a.element.removeAttr("pattern required");if(a.options.validatetype=="[0-9]*"){a.element.attr("type","tel");a.options.validatetype="number"}$.extend(a.options,a.element.data());if(a.element[0].tagName.toLowerCase()==="select"||(a.element[0].type&&"month,date,checkbox".indexOf(a.element[0].type.toLowerCase())!==-1)){a.options.validateon="change"}a.$parent=a.element.parent();a.isValidated=false;a.validClass="u-validate--valid";a.invalidClass="u-validate--invalid";a.interval;a.currentValue=a.element.val();a.invalidDisplayed=[];a.$totalInvalidMsg=$("<span class='u-validate-invalid-total'></span>");a.$firstError;a.$lastError;a._build()},_build:function(){var a=this;"INPUT,TEXTAREA,SELECT".search(a.element[0].tagName)==-1?a._buildForm():a._buildField()},_buildForm:function(){var b=this;b.element.on("submit.validate, validate",function(e){var a=b._validateSection();a||b.showFirstInvalid();return a}).on("validatedisplayinvalid.validate","[data-validate]",function(e){var a=b.element.find("."+b.invalidClass+":not(:hidden)");b.$firstError=a.first();b.$lastError=a.last();if(b.invalidDisplayed.indexOf(this)==-1){b.invalidDisplayed.push(this);b._setInvalidMessageText();b.$totalInvalidMsg.appendTo(b.element)}}).on("validatedisplayvalid.validate","[data-validate]",function(e){var a=b.invalidDisplayed.indexOf(this),$errors=b.element.find("."+b.invalidClass+":not(:hidden)");b.$firstError=$errors.first();b.$lastError=$errors.last();if(a!=-1){b.invalidDisplayed.splice(a,1);b.invalidDisplayed.length?b._setInvalidMessageText():b.$totalInvalidMsg.removeClass("u-validate--above-fold, u-validate--below-fold")}}).on("click.validate",".u-validate-invalid-total",function(e){b.showFirstInvalid()});$(document).on("scroll.validate",function(e){var a,belowBottom;if(b.options.validateshowerrormessage&&b.invalidDisplayed.length){a=h.scrollTop()>=(b.$firstError.offset().top+b.$firstError.height()+b.options.validateoffsettop);belowBottom=h.innerHeight()+h.scrollTop()<=b.$lastError.offset().top-b.options.validateoffsetbottom;b.$totalInvalidMsg.toggleClass("u-validate-invalid-total--above-fold",a).toggleClass("u-validate-invalid-total--below-fold",belowBottom)}});b.options.validateshowerrormessage&&b.$totalInvalidMsg.appendTo(b.element)},_buildField:function(){var a=this,$field="";a.$parent.addClass("u-validate");a.options.validatemessagevalid&&a.$parent.attr("data-validatemessagevalid",a.options.validatemessagevalid);a.options.validatemessageinvalid&&a.$parent.attr("data-validatemessageinvalid",a.options.validatemessageinvalid);if(!a.options.validatedisplayname){$field=a.element.parents("label:first").clone();$field.find("*").remove();a.options.validatedisplayname=$field.text().trim().replace(/:.*/,"")}if(!a.options.validatedisplayname){a.options.validatedisplayname=a.element.attr("name")||"Field"}a._validateField(true);if(a.element[0].tagName.toLowerCase()==="select"){a.interval=f.setInterval(function(){if(a.element.val()&&a.element.val()!==a.currentValue){a.element.trigger("change")}},250)}a.element.on(a.options.validateon+".validate",function(e){a._validateField(true)}).on("focus.validate",function(e){a.display(false)}).on("blur.validate",function(e){a.display(true)})},validate:function(a){var b=this;"INPUT,TEXTAREA,SELECT".search(b.element[0].tagName)==-1?b._validateSection():b._validateField(a);return b.isValidated},isValid:function(){var a=this;return a.isValidated},display:function(a,b){var c=this,valid;c.$parent.removeClass(c.validClass+" "+c.invalidClass);if(a){valid=c.isValidated?((b||c.element.val())&&"valid"):"invalid";c.$parent.addClass(c[valid+"Class"]);c._trigger("display"+valid)}else{c._trigger("displayvalid")}},showFirstInvalid:function(){var a=this;a.$firstError[0]&&(h.scrollTop()>=a.$firstError.offset().top)&&h.scrollTop(a.$firstError.length?a.$firstError.offset().top-a.options.validateoffsetfirsterror:h.scrollTop())},_validateSection:function(){var b=this,formValid=true;$(b.element).find("input[data-validate], textarea[data-validate], select[data-validate]").each(function(i,v){var a=$(this);a.validate("display",true);if(!a.validate("isValid")){formValid=false}});b.isValidated=formValid;b._trigger("customsection");return formValid},_validateField:function(a){var b=this,process=b.options.validatetype||b.element.attr("type")||"text",value=b.element.val()||"";b.currentValue=value;if(!b.options.required&&!value.length){b.isValidated=true}else if(b.options.required&&!value.length){b.isValidated=false}else if(process instanceof RegExp){b.isValidated=process.test(value)}else if(typeof process==="string"&&/^\/.+\/[a-z]*/.test(process)){process=new RegExp(process.replace(/^\/|\/[a-z]*$/g,""),process.replace(/^\/.+\//,""));b.isValidated=process.test(value)}else if(b.options.required&&process==="checkbox"){b.isValidated=b.element.is(":checked")}else if(process=="ccn"){var c=0,nDigit=0,bEven=false;if(/[^0-9-\s]+/.test(value)){b.isValidated=false}else{value=value.replace(/\D/g,"");for(var i=value.length-1;i>=0;i--){var d=value.charAt(i),nDigit=parseInt(d,10);bEven&&((nDigit*=2)>9)&&(nDigit-=9);c+=nDigit;bEven=!bEven}b.isValidated=(c%10)==0}}else if(process=="month"||process=="date"){Date.prototype.isValid=function(){return this instanceof Date&&!isNaN(this.valueOf())};var e=b.element[0],fieldDate=new Date(value),checkDate,validDate=fieldDate.isValid();if(validDate&&e.min){checkDate=new Date(e.min);validDate=validDate&&checkDate.isValid()&&fieldDate-checkDate>=0}if(validDate&&e.max){checkDate=new Date(e.max);validDate=validDate&&checkDate.isValid()&&checkDate-fieldDate>=0}b.isValidated=validDate}else{b.isValidated=b._getPreset(process).test(value)}b._trigger("custom");b.display(!a);return b.isValidated},setValid:function(a){var b=this;b.isValidated=a?true:false},_getPreset:function(a){var b=this,zipList,zips,presets={empty:/^$/,required:/^.+$/,text:/^.+$/,email:/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,tel:/^(?:\+?1[-. ]?)?\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,number:/^[0-9]+$/,digit:/^[0-9]*?\.?[0-9]{1,2}$/,alpha:/^[A-Za-z ]+$/,upperalpha:/^[A-Z ]+$/,loweralpha:/^[a-z ]+$/,alphanumeric:/^[A-Za-z0-9 ]+$/},postalCodes={USA:"[0-9]{5}(-[0-9]{4})?",CAN:"([A-Za-z][0-9]){3}",MEX:"[0-9]{5}",AUS:"[0-9]{4}",HKG:"[0-9]{3}([0-9]{2})?",TWN:"[0-9]{3}([0-9]{2})?",GBR:"[A-Za-z0-9]{5,7}",ESP:"[0-9]{5}",SGP:"[0-9]{6}"};if(a.match("postalcode")){zips=[];zipList=a.match(/\((.*?)\)/)[1].split(",");zips.push("^");for(var i=0;i<zipList.length;i++){postalCodes[zipList[i]]&&zips.push("("+postalCodes[zipList[i]]+")$|")}zips=zips.join("");zips=new RegExp(zips.substring(0,zips.length-1))}b.options.validatetype=zips||presets[a]||presets.text;return b.options.validatetype},_setInvalidMessageText:function(){var a=this,labels=[],fieldLabel;for(var i=0;i<a.invalidDisplayed.length;i++){fieldLabel=$(a.invalidDisplayed[i]).validate("getDisplayName");fieldLabel&&labels.push(fieldLabel)}a.$totalInvalidMsg.attr("data-invalidcount",a.invalidDisplayed.length).text(labels.join(", "))},getDisplayName:function(){var a=this;return a.options.validatedisplayname},refresh:function(){var a=this;a._setInvalidMessageText()},_setOption:function(a,b){var c=this,oldValue=c.options[a],actions={validatemessagevalid:function(){b!==""?c.$parent.attr("data-validatemessagevalid",b):c.$parent.removeAttr("data-validatemessagevalid")},validatemessageinvalid:function(){b!==""?c.$parent.attr("data-validatemessageinvalid",b):c.$parent.removeAttr("data-validatemessageinvalid")},validateon:function(){c.element.off(oldValue+".validate").on(b+".validate",function(e){c._validateField()})},validateshowerrormessage:function(){b&&c.invalidDisplayed.length&&c.$totalInvalidMsg.appendTo(c.element);b||c.$totalInvalidMsg.detach()},validatedisplayname:function(){c.element.parents("[data-validate]:first").validate("refresh")}};$.Widget.prototype._setOption.apply(c,arguments);c._trigger("setOption",{type:"setOption"},{option:a,original:oldValue,current:b});actions[a]&&actions[a]()},destroy:function(){var a=this;a.element.off(".validate, validate").removeData("validatedisplayname");clearInterval(a.interval);a.$parent.removeAttr("data-validatemessagevalid data-validatemessageinvalid").removeClass("u-validate "+a.validClass+" "+a.invalidClass);$.Widget.prototype.destroy.call(a)}});$(document).on("ready",function(e){$("body [data-validate]").validate()})})(jQuery,window);
